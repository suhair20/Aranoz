<%- include('../layout/user/header.ejs') %>
<style>
    .price {
    font-size: 16px; /* Adjust font size as needed */
}

.old-price {
    text-decoration: line-through;
    color: #888; /* Color for the strike-through */
}

.sale-price {
    color: #c00; /* Color for the discounted price */
}
  .left_widgets {
        margin-bottom: 20px;
    }

    .l_w_title h3 {
        color: #333;
        font-size: 18px;
        margin-bottom: 15px;
    }

    .widgets_inner ul {
        list-style: none;
        padding: 0;
        margin: 0;
    }

    .widgets_inner ul li {
        margin-bottom: 10px;
    }

    .widgets_inner ul li a {
        color: #666;
        text-decoration: none;
        font-size: 16px;
        transition: color 0.3s ease;
    }

    .widgets_inner ul li a:hover {
        color: #000;
    }
    .btn_3 {
    display: inline-block;
    padding: 0px 24px;
    border-radius: 50px;
    background-color: #ff3368;
    border: 1px solid #ecfdff;
    font-size: 15px;
    font-weight: 700;
    color: #fff;
    text-transform: uppercase;
    font-weight: 400;
    box-shadow: -1.717px 8.835px 29.76px 2.24px rgba(255, 51, 104, 0.18);
    border: 1px solid #ff3368;
    -webkit-transition: 0.5s;
    transition: 0.5s;
}
.search-form {
        display: flex; 
        align-items: center; 
    }

    .search-input {
        flex: 1; 
        margin-right: 0px; 
    }
</style>
  

    <!--================Home Banner Area =================-->
    <!-- breadcrumb start-->
    <section class="breadcrumb breadcrumb_bg">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-8">
                    <div class="breadcrumb_iner">
                        <div style="    margin-bottom: 220px;" class="breadcrumb_iner_item">
                            <h2  >Shop Category</h2>
                            <p style="    " >Home <span>-</span> Shop Category</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- breadcrumb start-->

    <!--================Category Product Area =================-->
    
    <section class="cat_product_area section_padding">
        <div class="container">
            <div class="row">
                <div class="col-lg-3">
                    <div class="left_sidebar_area">
                        <aside class="left_widgets p_filter_widgets">
                            <div class="l_w_title">
                               <a href="/shop"> <h3>Browse Categories</h3></a>
                            </div>
                            <%categoery.forEach((data) => {%>
                                
                           
                            <div class="widgets_inner">
                                <ul class="list">
                                    <li>
                                        <a  href="/shop?name=<%= encodeURIComponent(data._id) %>"><%=data.name%></a>
                                    </li>
                             
                                    
                            </div>
                        <%})%>
                      <a style="margin-left: 70px;     " href="/shop">  <button style="margin-top: 10px;" class="btn_3" >Back</button></a>
                        </aside>
                    </div>
                </div>
                <div class="col-lg-9">
                    <div class="row">
                        <div class="col-lg-12">
                            <div class="product_top_bar d-flex justify-content-between align-items-center">
                                <div class="single_product_menu">
                                    
                                </div>
                                <!-- <div class="single_product_menu d-flex">
                                    <h5>short by : </h5>
                                    <select>
                                        <option data-display="Select">name</option>
                                        <option value="1">price</option>
                                        <option value="2">product</option>
                                    </select>
                                </div> -->
                                <div class="single_product_menu d-flex">
                                    <h5>show :</h5>
                                    <div class="top_pageniation">
                                        <ul>
                                            <li>1</li>
                                            <li>2</li>
                                            <li>3</li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="single_product_menu d-flex">
                                    <div class="input-group">
                                    
                                        <form class="search-form" action="/shop" method="GET">
                                            <input class="search-input" name="search" type="text" placeholder="Search">
                                            <button class="search-button" type="submit">
                                                <i class="fa fa-search"></i>
                                            </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div  id="productContainer" class="row align-items-center latest_product_inner">
                     <% if(product.length!=0){%> 
                    <% product.forEach((user,index)=>{%>
                    
                        <div class="col-lg-4 col-sm-6">
                            <div class="single_product_item">
                              <a href="/singleproduct?id=<%=user._id%>">  <img src="/sharpimages/<%=user.images.image1%>" alt=""> </a>
                                <div id="reloadWishlist_<%= user._id %>" class="single_product_text">
                                    <h4><%=user.name%></h4>
                                    <div class="price">
                                        <% if (user.discountPrice) { %>
                                            <span class="old-price">₹<%= user.price %></span>&nbsp;&nbsp;
                                            <span class="sale-price">₹<%= user.discountPrice %></span>
                                        <% } else { %>
                                            <span style="color: red;" class="sale-price">₹<%= user.price %></span>
                                        <% } %>
                                    </div>
                                    
                                    <a  class="add_cart">+ add to cart</a>
                                       <a onclick="addTowhishlist('<%=user._id%>')"> <i class="ti-heart" ></i></a>
                                </div>
                            </div>
                        </div>
                      
                    <%})%>
                <%}else{%>

                    <% 
        if(typeof message !=='undefined'){
          %>
          <h5 style="    color: grey;
    margin-left: 260px;
    margin-top: 79px;" id="errorMessage"><%-message %></h5>

          <%
        }
        %>

                    <%} %>
                       
                      
                      
                      
                       
                          
                            
                       
                            
                        
                        
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!--================End Category Product Area =================-->

    <!-- product_list part start-->
 
    <!-- product_list part end-->
    <%- include('../layout/user/footer.ejs') %>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
  function addTowhishlist(productId){
    console.log("hahahah");
    $.ajax({
        url:'/getwhislist',
        method:'POST',
        data:{productId},
        success:function(response){
            if(response.add){
            console.log("verumooooooniiiiiiiiiiiiiiiiiiii");
                let productId = response.productId;
            
                $('#reloadWishlist_' + productId).fadeOut(300, function() {
                    $(this).load('/shop #reloadWishlist_' + productId, function() {
                        $(this).fadeIn(300);
                    });
                });
          

            }else if(response.remove){
                let productId = response.productId;
            
            $('#reloadWishlist_' + productId).fadeOut(300, function() {
                $(this).load('/shop #reloadWishlist_' + productId, function() {
                    $(this).fadeIn(300);
                });
            });
            }  else if(response.user){
                Swal.fire({
                    icon: "warning",
                    title: "Please Login",
                    confirmButtonColor: "#3085d6",
                    confirmButtonText: "Login",
                    showCancelButton: true,
                    cancelButtonColor: "#d33",
                }).then((result) => {
                    if (result.isConfirmed) {
                        location.href = "/login";
                    }
                });


            }
        }
    })
}

  


    </script>
    <script>
 


    </script>
  
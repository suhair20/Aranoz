<%- include('../layout/admin/header.ejs') %>
<script src="https://kit.fontawesome.com/14093101a5.js" crossorigin="anonymous"></script>
<style>





    body {
	margin: 0;
	padding: 0;
	font-family: sans-serif;
}
#hero {
	height: 50vh;
	width: 100%;
	background-image: url(asset/img/breadcrumb.png);
	color: black;
}
main {
	display: grid;
	grid-template-columns: 3fr 1fr;
}
nav {
	position: absolute;
	top: 0;
	width: 100%;
	
	color: black;
	padding: 10px 0;
	text-align: center;
	display: flex;
	
	z-index: 2;
    
}

nav a {
	color: black;
	text-decoration: none;
	padding: 10px 20px;
}

section {
	height: 100vh;
	display: flex;
	justify-content: center;
	align-items: center;
	font-size: 2rem;
	color: black;
}
#portfolio {
	background-color:aliceblue;
	flex-direction: column;
    
}
#press {
	background-color: #9e0059;
}
#shop {
	background-color: #ff0054;
}
#about {
	background-color: #390099;
}
.box {
	margin: 0;
	padding: 16px;
	width: 100%;
	height: 120px;
	background-color: aliceblue;
}
#social-nav {
	background: gold;
	position: sticky;
}

.container {
	position: relative;
    left: 0px;
    width: 81%;
    height: 72%;
    background-color: aliceblue;
    border-radius: 8px;

	
}
.contin{
	position: relative;
    left: 0px;
    width: 57%;
    
    background-color: aliceblue;
    margin-left: 23%;
    margin-top: 22%;
    border-radius: 10px;
    box-shadow: 0 0 10px;
}
	

.sec {
	width: 100%;
	height: 50%;
}
.sub-sticky {
	width: 100%;
	position: sticky;
	top: 0;
}
.sec a {
	text-decoration: none;
	padding: 8px;
	color: #fff;
	font-size: 18px;
	background: teal;
}
#s1 {
	background: hotpink;
}
#s2 {
	background: orange;
}
#s3 {
	background: purple;
}
#s4 {
	background: cyan;
}
</style>

<header>
	<nav id="sticky-nav">
		<a style="margin-left: 8%;" class="navbar-brand" href="index.html"> <img src="asset/img/logo.png" alt="logo"> </a>
		<a style="margin-left: 14%;" href="/home">Home</a>
		<a href="/shop">Shop</a>
		<a href="#shop">Pages</a>
		<a href="#about">Blog</a>
		<a href="/contact">Contact</a>
		<div style="    margin-top: 9px;     margin-left: 210px"><i class="fa-solid fa-magnifying-glass"></i></div>
		
	  <div     style="    margin-top: 9px;     margin-left: 30px">	<i class="fa-regular fa-heart"></i></div>
		<a href="/profile"><div style="    margin-top: 2px;    margin-left: 30px"><i class="fa-solid fa-user"></i></div></a>
		<a href="/cart"><div style="    margin-top: 2px  ;  margin-left: 30px;"><i class="fa-solid fa-cart-shopping"></i></div></a>
	</nav>
	<section id="hero">
		<div id="hero-text">
			<h2 style="    padding-right: 251px;">My Profile</h2>
			<p></p>
		</div>
	</section>
</header>

<main>
	<div class="main1">
		
		<section id="portfolio">
			
			<h2 style="margin-right: 60%;" >Change password</h2>
			<div  style="background-color: aliceblue;" class="container">
				 
				 
				<div class="contin">
					<div  class="col-md-12 form-group p_star">
						<input type="text" class="form-control" id="oldPassword" name="currentpassword" value=""
							placeholder="currentPassword">
					</div>
					<div class="col-md-12 form-group p_star">
						<input type="password" class="form-control" id="freshPassword" name="Newpassword" value=""
							placeholder=" New Password">
					</div>
					<div class="col-md-12 form-group p_star">
						<input type="password" class="form-control" id="freshConfirmation" name="password" value=""
							placeholder=" confirm Password">
					</div>
				</div>
					<div class="col-md-12 form-group">
						
						<p id="change-error" style="color: red;" class="error-message text-center"></p>
						<button style="    margin-left: 195px;" onclick="validateAndSubmit()" class="btn btn-primary btn-hover-dark">
							Save Change
						</button>
						
					</div>
				
			
				
				</div>
			</div>
		
	</div>
	<aside style="background-color: aliceblue;" id="aside">
       
		<div>
            <ul class="menu-aside">
                <li class="menu-item ">
                    <a class="menu-link" href="/profile">
                        <i class="icon material-icons md-home"></i>
                        <span  class="text">Dashboard</span>
                    </a>
                </li>
                <li class="menu-item  ">
                    <a class="menu-link" href="/profileorder">
                        <i class="icon material-icons md-shopping_bag"></i>
                        <span class="text">Order</span>
                    </a>
                    
                </li>
                <li class="menu-item ">
                    <a class="menu-link" href="/Wallet">
                        <i class="icon material-icons md-shopping_cart"></i>
                        <span class="text">Wallet</span>
                    </a>
                   
                </li>
                <li class="menu-item ">
                    <a class="menu-link" href="/profileaddress">
                        <i class="icon material-icons md-store"></i>
                        <span class="text">Address</span>
                    </a>
                    </li>
					<li class="menu-item active ">
						<a class="menu-link" href="">
							<i class="icon material-icons md-store"></i>
							<span class="text">password</span>
						</a>
						</li>
						<li class="menu-item ">
							<a class="menu-link" href="/profilelogout">
								<i class="icon material-icons md-store"></i>
								<span class="text">Logout</span>
							</a>
							</li>
                  
                
            
              
               
               
     
            </ul>
            <hr />
           
            
        </div>
		
		
	</aside>
</main>
<%- include('../layout/admin/footer.ejs') %>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<script>
    function validateAndSubmit() {
    const currentPassword = document.getElementById('oldPassword').value;
    const newPassword = document.getElementById('freshPassword').value;
    const confirmPassword = document.getElementById('freshConfirmation').value;
    const errorElement = document.getElementById('change-error');

    errorElement.innerText = '';

    if (!currentPassword) {
        errorElement.innerText = 'Please enter your current password.';
        return;
    }

    if (!newPassword) {
        errorElement.innerText = 'Please enter a new password.';
        return;
    }

    if (!confirmPassword) {
        errorElement.innerText = 'Please confirm your new password.';
        return;
    }

    if (newPassword != confirmPassword) {
        errorElement.innerText = 'Passwords do not match.';
        return;
    }

    callChangePassword(currentPassword, newPassword);
}
    function callChangePassword(current,newPass){
        $.ajax({
            url:'/changepassword',
            method:'POST',
            data:{current,newPass},
            success:function(data){
                if (data.success) {
					console.log("hiiiiii");
                Swal.fire({
                    icon: 'success',
                    title: 'Success',
                    text: data.message
                }).then(()=>{
                    location.reload()
                })
            } else {
                console.log('eroooooorrrrrrrrrrrrrrr');
                document.getElementById('change-error').innerText = data.message;
            }
            },
            error:function(err){

            }
        })
    }
    </script>
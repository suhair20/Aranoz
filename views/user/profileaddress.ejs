<%- include('../layout/admin/header.ejs') %>
<script src="https://kit.fontawesome.com/14093101a5.js" crossorigin="anonymous"></script>
<style>
    body {
	margin: 0;
	padding: 0;
	font-family: sans-serif;
}
#hero {
	height: 50vh;
	width: 100%;
	background-image: url(asset/img/breadcrumb.png);
	color: black;
}
main {
	display: grid;
	grid-template-columns: 3fr 1fr;
}
nav {
	position: fixed;
	top: 0;
	width: 100%;
	
	color: black;
	padding: 10px 0;
	text-align: center;
	display: flex;
	
	z-index: 2;
    box-shadow: 0 0 10px rgba(0,0,0);
}

nav a {
	color: black;
	text-decoration: none;
	padding: 10px 20px;
}

section {
	height: 100vh;
	display: flex;
	justify-content: center;
	align-items: center;
	font-size: 2rem;
	color: black;
}
#portfolio {
	background-color:whitesmoke;
	flex-direction: column;
    
}
#press {
	background-color: #9e0059;
}
#shop {
	background-color: #ff0054;
}
#about {
	background-color: #390099;
}
.box {
	margin: 0;
	padding: 16px;
	width: 100%;
	height: 120px;
	background-color: aliceblue;
}
#social-nav {
	background: gold;
	position: sticky;
}

.container {
	position: relative;
    left: 0px;
    width: 81%;
    height: 72%;
    
    border-radius: 8px;

	
}
.contin{
	position: relative;
    left: 0px;
    width: 57%;
    height: 40%;
    background-color: azure;
    margin-left: 23%;
    margin-top: 22%;
    border-radius: 10px;
    box-shadow: 0 0 10px;
}
	

.sec {
	width: 100%;
	height: 50%;
}
.sub-sticky {
	width: 100%;
	position: sticky;
	top: 0;
}
.sec a {
	text-decoration: none;
	padding: 8px;
	color: #fff;
	font-size: 18px;
	background: teal;
}
#s1 {
	background: hotpink;
}
#s2 {
	background: orange;
}
#s3 {
	background: purple;
}
#s4 {
	background: cyan;
}
</style>

<header>
	<nav id="sticky-nav">
		<a style="margin-left: 8%;" class="navbar-brand" href="index.html"> <img src="asset/img/logo.png" alt="logo"> </a>
		<a style="margin-left: 14%;" href="/home">Home</a>
		<a href="/shop">Shop</a>
		<a href="#shop">Pages</a>
		<a href="#about">Blog</a>
		<a href="/contact">Contact</a>
		<a><div   style="    margin-top: 9px;     margin-left: 210px"><i class="fa-solid fa-magnifying-glass"></i></div></a>
		
	  <div     style="    margin-top: 9px;     margin-left: 30px">	<i class="fa-regular fa-heart"></i></div>
		<a href="/profile"><div style="    margin-top: 9px;    margin-left: 30px"><i class="fa-solid fa-user"></i></div></a>
		<a href="/cart"><div style="    margin-top: 9px  ;  margin-left: 30px;"><i class="fa-solid fa-cart-shopping"></i></div></a>
	</nav>
	<section id="hero">
		<div id="hero-text">
			<h2 style="    padding-right: 251px;">My Profile</h2>
			<p></p>
		</div>
	</section>
</header>

<main>
	<div class="main1">
		<section id="portfolio">
			
			<h2 style="margin-right: 60%;" >User Address</h2>
		
	<div class="container">
				<button type="button" class="btn btn-warning  " data-bs-toggle="modal" data-bs-target="#addModal" style="width: 12%;height: 40px;margin-left: 13%;margin-top: 5%;"  >add+</button></a></a>
				<div class="row">
			<% if(detials && detials.address && detials.address.length>0){%>
			<% detials.address.forEach((data,index)=>{%>
		
				<div style="    margin-top: 16px; margin-left: 10%;" class="col-md-4">
                  <div class="border border-secondary">
					<h4 class="account-title text-center">
						Address<%=index+1%> <hr>
					</h4>
					<p style="    margin-left: 20px;">
						Name:<%=data.name%> <br>
						Address:<%=data.address%> <br>
						Landmark:<%=data.landmark%> <br>
						State:<%=data.state%> <br>
						City:<%=data.city%> <br>
						Pincode:<%=data.pincode%> <br>
						Phone:<%=data.phone%> <br>
						Email:<%=data.email%> <br>

					</p>
					<div>
				<a>	<i style="font-size: 1rem;margin-left: 5px;" data-id="<%=data._id%>" data-bs-toggle="modal" data-bs-target="#editModal" class="fa fa-edit"></i></a>
		    	<a data-user-id="<%=data._id%>" class="deleteButton" ><i style="font-size: 1rem;" 	class="fa fa-trash"></i></a>
			</div>
				  </div>

				</div>
				<%})%>
			<%}else{%>
			    <div  class="col-md-12">
                <p>NO Address found</p>
				</div>
				<%}%>		
		
				</div>
			</div>
			</div>
			</div>
		
	</div>
	<aside id="aside">
       
		<div>
            <ul class="menu-aside">
                <li class="menu-item ">
                    <a class="menu-link" href="/profile">
                        <i class="icon material-icons md-home"></i>
                        <span  class="text">Dashboard</span>
                    </a>
                </li>
                <li class="menu-item  ">
                    <a class="menu-link" href="/profileorder">
                        <i class="icon material-icons md-shopping_bag"></i>
                        <span class="text">Order</span>
                    </a>
                    
                </li>
                <li class="menu-item ">
                    <a class="menu-link" href="">
                        <i class="icon material-icons md-shopping_cart"></i>
                        <span class="text">Wallet</span>
                    </a>
                   
                </li>
                <li class="menu-item active ">
                    <a class="menu-link" href="/profileaddress">
                        <i class="icon material-icons md-store"></i>
                        <span class="text">Address</span>
                    </a>
                    </li>
					<li class="menu-item ">
						<a class="menu-link" href="/profilepassword">
							<i class="icon material-icons md-store"></i>
							<span class="text">password</span>
						</a>
						</li>
						<li class="menu-item ">
							<a class="menu-link" href="/profilelogout">
								<i class="icon material-icons md-store"></i>
								<span class="text">Logout</span>
							</a>
							</li>
                  
                
            
              
               
               
     
            </ul>
            <hr />
           
            
        </div>
		
		
	</aside>


<div class="modal fade" id="editModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title" id="exampleModalLabel">Edit Address</h3>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form method="post" action="/editADDRUpdate">
			<div class="row">
			<div class="col-md-6">
          <div class="mb-3">
            <label for="recipient-name" class="col-form-label">Name:</label>
            <input type="text" name="namee" class="form-control" id="recipient-name"> 
			<input type="hidden" name="id" id="recipient-id"  >   
          </div>
		  <div class="mb-3">
            <label for="recipient-name" class="col-form-label">Address:</label>
            <input type="text" name="addresse" class="form-control" id="recipient-address">
          </div>
		  <div class="mb-3">
            <label for="recipient-name" class="col-form-label">Landmark:</label>
            <input type="text" name="Landmarke" class="form-control" id="recipient-landmark">
          </div>
		  <div class="mb-3">
            <label for="recipient-name" class="col-form-label">State:</label>
            <input type="text" name="statee" class="form-control" id="recipient-state">
			
          </div>
			</div>
			<div class="col-md-6">
		  <div class="mb-3">
            <label for="recipient-name" class="col-form-label">City:</label>
            <input type="text" name="citye" class="form-control" id="recipient-city">
          </div>
		  <div class="mb-3">
            <label for="recipient-name" class="col-form-label">Pincode:</label>
            <input type="text" name="pincode" class="form-control" id="recipient-pincode">
          </div>
		  <div class="mb-3">
            <label for="recipient-name" class="col-form-label">phone:</label>
            <input type="text" name="phonee" class="form-control" id="recipient-phone">
          </div>
		  <div class="mb-3">
            <label for="recipient-name" class="col-form-label">Email:</label>
            <input type="text" name="emaile" class="form-control" id="recipient-email">
          </div>
		</div>
		<div class="col-md-12">
		<div class="modal-footer">
		  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
		  <button type="submit" class="btn btn-info">update</button>
		</div>
      </div>
         </div>
        </form>
     </div>
    </div>
  </div>
</div>



<!-- //add address// -->

<div class="modal fade" id="addModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
	<div class="modal-dialog">
	  <div class="modal-content">
		<div class="modal-header">
		  <h3 class="modal-title" id="exampleModalLabel">Add Address</h3>
		  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
		</div>
		<div class="modal-body">
		  <form method="post" action="/addAddress">
			  <div class="row">
			  <div class="col-md-6">
			<div class="mb-3">
			  <label for="recipient-name" class="col-form-label">Name:</label>
			  <input type="text" name="name" class="form-control" id="">
			</div>
			<div class="mb-3">
			  <label for="recipient-name" class="col-form-label">Address:</label>
			  <input type="text" name="address" class="form-control" id="">
			</div>
			<div class="mb-3">
			  <label for="recipient-name" class="col-form-label">Landmark:</label>
			  <input type="text" name="landmark" class="form-control" >
			</div>
			<div class="mb-3">
			  <label for="recipient-name" class="col-form-label">State:</label>
			  <input type="text" name="state" class="form-control" id="">
			</div>
			  </div>
			  <div class="col-md-6">
			<div class="mb-3">
			  <label for="recipient-name" class="col-form-label">City:</label>
			  <input type="text" name="city" class="form-control" id="">
			</div>
			<div class="mb-3">
			  <label for="recipient-name" class="col-form-label">Pincode:</label>
			  <input type="text" name="pincode" class="form-control" id="">
			  
			</div>
			<div class="mb-3">
			  <label for="recipient-name" class="col-form-label">phone:</label>
			  <input type="text" name="phone" class="form-control" id="">
			</div>
			<div class="mb-3">
			  <label for="recipient-name" class="col-form-label">Email:</label>
			  <input type="text" name="email" class="form-control" id="">
			</div>
		  </div>
		  <div class="col-md-12">
		  <div class="modal-footer">
			<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
			<button type="submit" class="btn btn-warning">Add</button>
		  </div>
		</div>
		   </div>
		  </form>
	   </div>
	  </div>
	</div>
  </div>
</main>
<%- include('../layout/admin/footer.ejs') %>

<script>
$(document).ready(function(){
	$('#editModal').on('show.bs.modal',function(event){
		console.log("hiii");
		var button=$(event.relatedTarget);
		var productId=button.data('id');
		$('#recipient-id').val(productId)

		$.ajax({
			url:'/addresdetials/'+productId,
			method:'GET',
			success:function(data){
				
				$('#recipient-name').val(data.address.name)
                $('#recipient-address').val(data.address.address)
                $('#recipient-landmark').val(data.address.landmark)
                $('#recipient-state').val(data.address.state)
                $('#recipient-city').val(data.address.city)
				$('#recipient-pincode').val(data.address.pincode)
				$('#recipient-phone').val(data.address.phone)
				$('#recipient-email').val(data.address.email)
			}
		})
	})
})

</script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
        
<script>
document.querySelectorAll('.deleteButton').forEach(button => {
    button.addEventListener('click', async function() {
        var UserDataElement = button;
        var productId = UserDataElement.getAttribute('data-user-id');
		  
		const result = await Swal.fire({
		title: "Are you sure?",
		text: "You won't be able to revert this!",
		icon: "warning",
		showCancelButton: true,
		confirmButtonColor: "#3085d6",
		cancelButtonColor: "#d33",
		confirmButtonText: "Yes, delete it!",
	  });
	  if (result.isConfirmed) {
		try {
	   
	   
		  const response = await fetch(`/deletaddress/${productId}`, {
			method: 'DELETE',
		   });
	 if (response.ok) {
			location.reload()
			} else {
			
			Swal.fire({
			  title: "Error",
			  text: "Failed to delete the product.",
			  icon: "error",
			});
		  }
		} catch (error) {
		
		  console.error(error);
	
		  Swal.fire({
			title: "Error",
			text: "An unexpected error occurred.",
			icon: "error",
		  });
		}
	  }
	});
})
	</script>
	<script>
    
		function validateForm(){
		  console.log("yyyyyy");
		  
			
		  
		  
		  console.log("hetttt");
		  var name=document.getElementById('idname').value
		  var email=document.getElementById('idemail').value
		  var mobile=document.getElementById('idmobile').value
		  var city=document.getElementById('idcity').value
		  var landmark=document.getElementById('idlandmark').value
		  var pinCode=document.getElementById('idpincode').value
		  var state=document.getElementById('idstate').value
		  var address=document.getElementById('idaddress').value
		  if(name==""||email==""||mobile==""||city==""||landmark==""||pinCode==""||state==""||address==""){
			  document.getElementById("Error").innerText="Empty input field . pleas fill "
			  return false
		  }
		  if(!/^[a-zA-Z\s]+$/.test(name)) {
			
			  document.getElementById("nameError").innerText="pleas enter name "
			  return false
		  }else{
			document.getElementById('nameError').innerText=""
  
		  }if(!/^[a-zA-Z_.-]+@[a-zA-Z-]+\.[a-zA-Z]{2,4}$/.test(email)){
		  document.getElementById("emailError").innerText="pleas enter valid email"
		  return false
		  }else{
			document.getElementById('emailError').innerText=""
		  }if(!/^\d{10}$/.test(mobile)){
		  document.getElementById("mobileError").innerText="pleas enter 10 digit number"
		  return false
		}else{
		  document.getElementById("mobileError").innerText=""
		}if(!/^[a-zA-Z\s]+$/.test(city)) {
			
			document.getElementById("cityError").innerText="pleas enter City "
			return false
		}else{
		  document.getElementById('cityError').innerText=""
  
		} if (!/^\d{6}$/.test(pinCode)) {
	  document.getElementById("pincodeError").innerText = "Please enter a valid 6-digit PIN code.";
	  return false;
	} else {
	  document.getElementById('pincodeError').innerText = "";
	} if (!/^[a-zA-Z0-9\s]+$/.test(landmark)) {
	  document.getElementById("landmarkError").innerText = "Please enter a valid landmark.";
	  return false;
	} else {
	  document.getElementById('landmarkError').innerText = "";
	}if(!/^[a-zA-Z\s]+$/.test(state)) {
			
	  document.getElementById("statekError").innerText="pleas enter state "
			return false
   }else{
		  document.getElementById('stateError').innerText=""
  
   }if (!/^[a-zA-Z0-9\s.,\-\/]+$/.test(address)) {
	  document.getElementById("addressError").innerText = "Please enter a valid address.";
	  return false;
	} else {
	  document.getElementById('addressError').innerText = "";
	}
			   return true
  }
		
	  
	  </script>